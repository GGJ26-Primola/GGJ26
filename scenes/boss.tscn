[gd_scene format=3 uid="uid://ctio65mmg2fab"]

[ext_resource type="Script" uid="uid://d0c0tclcwrgkl" path="res://scripts/boss.gd" id="1_neq0i"]
[ext_resource type="Texture2D" uid="uid://xp817dx81uy0" path="res://assets/2D/boss_spreadsheet.png" id="2_jncid"]
[ext_resource type="PackedScene" uid="uid://c4pfeujhlittk" path="res://scenes/mist.tscn" id="3_jncid"]
[ext_resource type="Texture2D" uid="uid://b25uubmxhjsvw" path="res://assets/2D/boss_scream.png" id="4_qnbj4"]
[ext_resource type="Script" uid="uid://batfik7aklbx1" path="res://scripts/scream.gd" id="4_r3bxh"]

[sub_resource type="Animation" id="Animation_jncid"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}

[sub_resource type="Animation" id="Animation_qnbj4"]
resource_name = "bullets_in"
length = 1.5
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [4, 5, 6]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("..:can_shoot")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 1.5),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [false, true]
}

[sub_resource type="Animation" id="Animation_r3bxh"]
resource_name = "bullets_out"
length = 1.5
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [6, 5, 4]
}

[sub_resource type="Animation" id="Animation_wqpjq"]
resource_name = "charging"
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [2, 3]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("..:can_mist")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0.9),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}

[sub_resource type="Animation" id="Animation_5f346"]
resource_name = "charging_scream"
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [9]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = false
tracks/1/path = NodePath("..:can_scream")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="Animation" id="Animation_0onds"]
resource_name = "damage"
length = 0.5
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.19999996, 0.29999998, 0.4),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 1,
"values": [13, 14, 13, 14, 13]
}

[sub_resource type="Animation" id="Animation_2cdgk"]
resource_name = "idle"
loop_mode = 1
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [0, 1]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("..:can_die")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="Animation" id="Animation_qsl3t"]
resource_name = "mist"
loop_mode = 1
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [7, 8]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("..:can_mist")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="Animation" id="Animation_8eiau"]
resource_name = "no_damage"
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [13]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("..:can_die")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(1),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}

[sub_resource type="Animation" id="Animation_2avx2"]
resource_name = "scream"
length = 0.5
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [10, 11]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("..:can_scream")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0.3, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [true, false]
}

[sub_resource type="Animation" id="Animation_lfs1x"]
resource_name = "weak"
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [12, 13]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_qsl3t"]
_data = {
&"RESET": SubResource("Animation_jncid"),
&"bullets_in": SubResource("Animation_qnbj4"),
&"bullets_out": SubResource("Animation_r3bxh"),
&"charging": SubResource("Animation_wqpjq"),
&"charging_scream": SubResource("Animation_5f346"),
&"damage": SubResource("Animation_0onds"),
&"idle": SubResource("Animation_2cdgk"),
&"mist": SubResource("Animation_qsl3t"),
&"no_damage": SubResource("Animation_8eiau"),
&"scream": SubResource("Animation_2avx2"),
&"weak": SubResource("Animation_lfs1x")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_jncid"]
animation = &"bullets_in"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qnbj4"]
animation = &"bullets_out"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_r3bxh"]
animation = &"charging"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qsl3t"]
animation = &"charging_scream"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2avx2"]
animation = &"damage"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_wqpjq"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2cdgk"]
animation = &"mist"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_lfs1x"]
animation = &"no_damage"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_0onds"]
animation = &"scream"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5f346"]
animation = &"weak"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qnbj4"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_2cdgk"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_wqpjq"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_jncid"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_5f346"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qsl3t"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_r3bxh"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_2avx2"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0onds"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_lfs1x"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_8eiau"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_vn2fc"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gqd3i"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_mautr"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ho3mf"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7apjh"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qh5fr"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_4dlq0"]

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_jncid"]
states/bullets_in/node = SubResource("AnimationNodeAnimation_jncid")
states/bullets_in/position = Vector2(588.36804, 48.799995)
states/bullets_out/node = SubResource("AnimationNodeAnimation_qnbj4")
states/bullets_out/position = Vector2(588.4, 163.2)
states/charging/node = SubResource("AnimationNodeAnimation_r3bxh")
states/charging/position = Vector2(455.6, 100.8)
states/charging_scream/node = SubResource("AnimationNodeAnimation_qsl3t")
states/charging_scream/position = Vector2(455.76, 268.8)
states/damage/node = SubResource("AnimationNodeAnimation_2avx2")
states/damage/position = Vector2(170.14243, 334.0384)
states/idle/node = SubResource("AnimationNodeAnimation_wqpjq")
states/idle/position = Vector2(350.00003, 163.3472)
states/mist/node = SubResource("AnimationNodeAnimation_2cdgk")
states/mist/position = Vector2(455.44, 13.599998)
states/no_damage/node = SubResource("AnimationNodeAnimation_lfs1x")
states/no_damage/position = Vector2(11.000002, 334.0707)
states/scream/node = SubResource("AnimationNodeAnimation_0onds")
states/scream/position = Vector2(614, 267.03998)
states/weak/node = SubResource("AnimationNodeAnimation_5f346")
states/weak/position = Vector2(349.71906, 349.75998)
transitions = ["bullets_in", "bullets_out", SubResource("AnimationNodeStateMachineTransition_qnbj4"), "idle", "charging", SubResource("AnimationNodeStateMachineTransition_2cdgk"), "bullets_out", "idle", SubResource("AnimationNodeStateMachineTransition_wqpjq"), "charging", "bullets_in", SubResource("AnimationNodeStateMachineTransition_jncid"), "Start", "idle", SubResource("AnimationNodeStateMachineTransition_5f346"), "charging", "mist", SubResource("AnimationNodeStateMachineTransition_qsl3t"), "mist", "charging", SubResource("AnimationNodeStateMachineTransition_r3bxh"), "charging", "idle", SubResource("AnimationNodeStateMachineTransition_2avx2"), "idle", "charging_scream", SubResource("AnimationNodeStateMachineTransition_0onds"), "charging_scream", "scream", SubResource("AnimationNodeStateMachineTransition_lfs1x"), "scream", "weak", SubResource("AnimationNodeStateMachineTransition_8eiau"), "weak", "damage", SubResource("AnimationNodeStateMachineTransition_vn2fc"), "scream", "charging_scream", SubResource("AnimationNodeStateMachineTransition_gqd3i"), "charging_scream", "idle", SubResource("AnimationNodeStateMachineTransition_mautr"), "damage", "idle", SubResource("AnimationNodeStateMachineTransition_ho3mf"), "damage", "no_damage", SubResource("AnimationNodeStateMachineTransition_7apjh"), "no_damage", "damage", SubResource("AnimationNodeStateMachineTransition_qh5fr"), "idle", "no_damage", SubResource("AnimationNodeStateMachineTransition_4dlq0")]
graph_offset = Vector2(-230, 52)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_jncid"]
transparency = 1
cull_mode = 2
albedo_texture = ExtResource("4_qnbj4")
uv1_scale = Vector3(10, 10, 10)
texture_filter = 0
point_size = 8.5

[sub_resource type="SphereMesh" id="SphereMesh_jncid"]
material = SubResource("StandardMaterial3D_jncid")
radius = 1.0
is_hemisphere = true

[sub_resource type="SphereShape3D" id="SphereShape3D_r3bxh"]
radius = 1.0

[sub_resource type="BoxShape3D" id="BoxShape3D_r3bxh"]
size = Vector3(5, 1, 2)

[node name="Boss" type="Node3D" unique_id=1656814271]
script = ExtResource("1_neq0i")

[node name="Sprite3D" type="Sprite3D" parent="." unique_id=80689855]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3, 0)
pixel_size = 0.03
texture_filter = 0
texture = ExtResource("2_jncid")
hframes = 4
vframes = 4

[node name="AnimationPlayer" type="AnimationPlayer" parent="." unique_id=1667033057]
root_node = NodePath("../Sprite3D")
libraries/ = SubResource("AnimationLibrary_qsl3t")

[node name="AnimationTree" type="AnimationTree" parent="." unique_id=1711742388]
root_node = NodePath("../Sprite3D")
tree_root = SubResource("AnimationNodeStateMachine_jncid")
anim_player = NodePath("../AnimationPlayer")

[node name="bullets" type="Node3D" parent="." unique_id=1585150938]

[node name="mist" parent="." unique_id=1045705961 instance=ExtResource("3_jncid")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 2.187)
visible = false
size = Vector3(5.54, 2, 3)

[node name="Timer" type="Timer" parent="." unique_id=1031802002]
wait_time = 3.0
one_shot = true

[node name="scream" type="Node3D" parent="." unique_id=175238670]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0)
script = ExtResource("4_r3bxh")

[node name="MeshInstance3D" type="MeshInstance3D" parent="scream" unique_id=410133]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.5, 0)
mesh = SubResource("SphereMesh_jncid")

[node name="Hitbox" type="Area3D" parent="scream" unique_id=929374536]
collision_layer = 8
collision_mask = 2

[node name="CollisionShape3D" type="CollisionShape3D" parent="scream/Hitbox" unique_id=395764823]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.5, 0)
shape = SubResource("SphereShape3D_r3bxh")

[node name="BossHitbox" type="Area3D" parent="." unique_id=539125056]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
collision_layer = 8
collision_mask = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="BossHitbox" unique_id=414436483]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.5)
shape = SubResource("BoxShape3D_r3bxh")

[connection signal="timeout" from="Timer" to="." method="_on_timer_timeout"]
[connection signal="body_entered" from="scream/Hitbox" to="scream" method="_on_hitbox_body_entered"]
[connection signal="body_exited" from="scream/Hitbox" to="scream" method="_on_hitbox_body_exited"]
[connection signal="area_entered" from="BossHitbox" to="." method="_on_boss_hitbox_area_entered"]
